# PayNow 物流系統簡訊樣板盤點報告

## 📋 報告概述

本報告盤點 PayNow 物流系統中所有寄送給**消費者**和**商家**的簽訊樣板。系統使用 `MessageHelper.SendSms()` 方法統一發送簡訊,排除寄送給維運人員的系統告警簡訊。

**報告產生日期**: 2025-10-17
**程式碼位置**: `PayNowLogistics\Helpers\MessageHelper.cs`

---

## 🎯 簡訊發送機制

### 核心方法
- **方法名稱**: `MessageHelper.SendSms()`
- **API端點**: `https://message.paynow.com.tw/api/sms`
- **簡訊提供商**: Every8D (預設)
- **字數限制**: 80字 (超過會自動截斷商家網站名稱)

### 發送流程

#### 流程一:商家帳號認證簡訊 (即時發送)
```
使用者登入
→ MemberController
→ 組裝認證碼簡訊
→ MessageHelper.SendSms()
→ 簡訊服務平台
```
- **觸發時機**: 商家首次登入或需要驗證時
- **發送方式**: 即時同步發送
- **無資料庫記錄**: 不寫入 MailList 資料表

#### 流程二:到店通知簡訊 (排程批次發送)
```
物流商回傳到店狀態
→ 寫入 MailList 資料表 (MailStatus=1, smsUUID, sms_batchsending_key=NULL)
→ Hangfire 定時排程 (sched_smsToBuyer)
→ Cls_Order.SendSMS_MailList()
→ 從 MailList 查詢未發送的簡訊 (sms_batchsending_key IS NULL)
→ 呼叫 SmsContent() 組裝簡訊內容
→ 批次呼叫 MessageHelper.SendSms()
→ 更新 MailList.sms_batchsending_key (標記已發送)
```
- **觸發時機**: 包裹到店後,排程定時執行
- **發送方式**: 批次發送 (每批可設定數量)
- **追蹤機制**: 透過 smsUUID 和 sms_batchsending_key

#### 流程三:第二次催取簡訊 (排程批次發送)
```
首次簡訊發送後一段時間
→ 寫入 MailList2nd 資料表 (smsUUID, sms_batchsending_key=NULL)
→ Hangfire 定時排程 (sched_smsToBuyer2nd)
→ Cls_Order.SendSMS_MailList_2nd()
→ 從 MailList2nd 查詢未發送的簡訊
→ 呼叫 SmsContent() 組裝簡訊內容
→ 批次呼叫 MessageHelper.SendSms()
→ 更新 MailList2nd.sms_batchsending_key
```
- **觸發時機**: 首次到店通知後,排程定時執行
- **發送方式**: 批次發送
- **內容更新**: 到期天數會重新計算

#### 流程四:退貨到店通知簡訊 (排程批次發送)
```
退貨商品送達退件門市
→ 寫入 MailList 資料表 (MailStatus=2, smsUUID, sms_batchsending_key=NULL)
→ Hangfire 定時排程 (sched_smsToBuyer)
→ Cls_Order.SendSMS_MailList()
→ 從 MailList 查詢未發送的退貨簡訊
→ 呼叫 SmsContent() 組裝簡訊內容
→ 批次呼叫 MessageHelper.SendSms()
→ 更新 MailList.sms_batchsending_key
```
- **觸發時機**: 退貨到店後,排程定時執行
- **收件人**: 寄件人 (商家)
- **與到店通知使用相同排程**: sched_smsToBuyer

### 資料表追蹤機制

#### MailList 資料表
- **用途**: 記錄首次簡訊和退貨簡訊的發送狀態
- **關鍵欄位**:
  - `smsUUID`: 簡訊唯一識別碼 (GUID)
  - `sms_batchsending_key`: 批次發送批號 (NULL=未發送, 有值=已發送)
  - `MailStatus`: `1`=到店通知, `2`=退貨通知

#### MailList2nd 資料表
- **用途**: 記錄第二次催取簡訊的發送狀態
- **關鍵欄位**:
  - `smsUUID`: 簡訊唯一識別碼
  - `sms_batchsending_key`: 批次發送批號

### 簡訊類型枚舉 (smsenum)
- `sched_smsToBuyer`: 首次到店通知 + 退貨通知
- `sched_smsToBuyer2nd`: 第二次催取通知
- `system_alert`: 系統告警 (維運人員,不在盤點範圍)
- `sched_smsToSender`: **⚠️ 已廢棄** (只有定義,從未使用)

---

## 📱 簡訊樣板分類

### 一、消費者簡訊 (買家/收件人)

#### 1.1 商家帳號認證簡訊
**使用場景**: 商家首次登入需要驗證手機號碼

**程式碼位置**: `Areas\Member\Controllers\MemberController.cs:6502`, `6737`

**樣板內容**:
```
您Paynow物流平台的認證碼是:{checkpw}
```
或
```
您paynow物流平台的認證碼是:{checkpw}
```

**⚠️ 程式碼問題**: 兩處程式碼的大小寫不一致 (Paynow vs paynow),建議統一為 PayNow

**變數說明**:
| 變數名稱 | 資料來源 | 資料表欄位 | 說明 | 可能值範例 |
|---------|---------|-----------|------|-----------|
| `checkpw` | `member.checkpw` | `member.checkpw` | 系統產生的認證碼 | 6位數字驗證碼 |

**收件人**:
- 電話號碼來源: `member.mem_telpcontect` (加密儲存)
- 對象: 商家主帳號聯絡電話

**業務規則**:
- 僅在 `mem_Power = 3` (未開通狀態) 時發送
- 用於主帳號首次開通認證

---

#### 1.2 到店通知簡訊 (第一次)
**使用場景**: 包裹送達超商門市時通知買家取貨

**程式碼位置**: `Models\Cls_Order.cs:21039`, `21084`

**樣板格式**:
```
您於{商家網站名稱}消費的貨品已送達{物流商}{門市名稱}門市  請於{天數}日內完成取貨
```

**實際範例**:
```
您於PayNow測試商店消費的貨品已送達7-11竹北光明門市  請於7日內完成取貨
您於WACA購物網消費的貨品已送達全家台北信義門市  請於2025/10/20前完成取貨
```

**變數說明**:
| 變數名稱 | 資料來源 | 資料表欄位 | 說明 | 可能值範例 |
|---------|---------|-----------|------|-----------|
| `商家網站名稱` | `Branch_Member.mem_Branchwebname` | `Branch_Member.mem_Branchwebname` | 商家分店網站名稱 | PayNow測試商店、WACA購物網 |
| `物流商` | `GetLogistic_ServiceCVSName()` | `LogisticService` | 超商名稱 | 7-11、全家、萊爾富、OK |
| `門市名稱` | `Order_Info.receiver_storename` 或 API查詢 | `Order_Info.receiver_storename` | 取貨門市名稱 | 竹北光明門市、台北信義門市 |
| `天數` | `GetLogistic_ReturnDayStr()` 或固定天數 | 計算邏輯 | 剩餘取貨天數或指定日期 | 7、今、2025/10/20前 |

**收件人**:
- 電話號碼來源: `Order_Info.Receiver_Phone` (加密儲存)
- 對象: 買家/收件人

**業務規則**:
- 不適用物流服務: `04`(全家B2C), `03`(全家C2C), `23`(全家冷凍), `24`(全家冷凍B2C), `10`(黑貓宅配)
- 7-11特殊處理: `eshopid=73E/73F` 的訂單由7-11自行發送簡訊,PayNow不重複發送
- 門市名稱處理:
  - 全家門市會移除前綴"全家"兩字
  - 若資料庫無門市名稱,會透過API即時查詢
  - 自動補上"門市"後綴(若原名稱不含"門市"字樣)
- 字數超過80字時,會自動截短`商家網站名稱`

**發送時機**:
- 定時排程 (Hangfire Job): `sched_smsToBuyer`
- 包裹到店後首次通知

---

#### 1.3 到店通知簡訊 (第二次催取)
**使用場景**: 包裹到店後隔一段時間再次提醒買家取貨

**程式碼位置**: `Models\Cls_Order.cs:21390`, `21350`

**樣板格式**:
```
您於{商家網站名稱}消費的貨品已送達{物流商}{門市名稱}門市  請於{天數}日內完成取貨
```

**與第一次簡訊的差異**:
- 內容格式相同,但發送時機不同
- 更新的到期天數 (扣除已過天數)
- 支援指定日期格式 (例: `2025/10/20前`)

**變數說明**: 同 1.2

**業務規則**:
- 僅針對特定物流服務發送: `01`(7-11), `02`(全家), `22`(黑貓低溫宅配)
- 黑貓低溫宅配固定4天取貨期限
- 其他規則同 1.2

**發送時機**:
- 定時排程: `sched_smsToBuyer2nd`
- 首次通知後的第二次催取

---

#### 1.4 退貨到店通知簡訊 (寄件人)
**使用場景**: 退貨商品送回退件門市時通知寄件人(商家)領取

**程式碼位置**: `Models\Cls_Order.cs:21084`

**樣板格式**:
```
訂單編號:{訂單編號}的退貨商品已抵達{退件門市}  請於{天數}日內前往領取  貨運編號:{貨運單號}
```

**實際範例**:
```
訂單編號:W7J9JQZQD1735193909的退貨商品已抵達7-11竹北光明門市  請於7日內前往領取  貨運編號:N0871666
訂單編號:WXRAR8GLK1735201551的退貨商品已抵達退件門市  請於今日內前往領取  貨運編號:N0928478
```

**⚠️ 程式碼問題**: 目前 `Cls_Order.cs:20465` 缺少「前」字,顯示「往領取」而非「前往領取」,建議修正

**變數說明**:
| 變數名稱 | 資料來源 | 資料表欄位 | 說明 | 可能值範例 |
|---------|---------|-----------|------|-----------|
| `訂單編號` | `Order_Info.OrderNo` | `Order_Info.OrderNo` | 商家訂單編號 | W7J9JQZQD1735193909 |
| `退件門市` | `Order_Info.return_storename` | `Order_Info.return_storename` | 退貨領取門市名稱 | 7-11竹北光明門市、退件門市 |
| `天數` | 計算邏輯 | - | 剩餘領取天數 | 7、今 |
| `貨運單號` | `Order_Info.paymentno` | `Order_Info.paymentno` | 物流商貨運追蹤號碼 | N0871666 |

**收件人**:
- 電話號碼來源: `Order_Info.Sender_Phone` (加密儲存)
- 對象: 寄件人(通常是商家)

**業務規則**:
- 不適用物流服務: `03`(全家C2C), `23`(全家冷凍), `10`(黑貓宅配)
- 門市名稱處理:
  - 若 `return_storename` 為空或 `NNNNNN`,顯示"退件門市"
  - 自動補上"門市"後綴
- 天數顯示邏輯:
  - `>= 1日`: 顯示"{天數}日內"
  - `0日`: 顯示"今日內"

**發送時機**:
- 定時排程: `sched_smsToBuyer` (與到店通知使用相同排程)
- 退貨商品到達退件門市後

---

## 🔍 變數資料來源詳細說明

### 資料庫欄位對應

#### Branch_Member 資料表
- **mem_Branchwebname**: 商家分店網站名稱 (加密儲存)
  - 用途: 簡訊中顯示的商家名稱
  - 異動可能性: 商家可透過後台修改,但不頻繁
  - 字數限制影響: 超過80字時會被自動截短

- **mem_telpcontect**: 商家聯絡電話 (加密儲存)
  - 用途: 帳號認證簡訊的接收電話
  - 異動可能性: 較少異動,僅在商家變更聯絡資訊時

#### Order_Info 資料表
- **LogisticNumber**: PayNow物流單號
  - 格式: `ALOA0017C12412263333`
  - 異動可能性: 建單後不變

- **paymentno**: 物流商貨運追蹤號碼
  - 格式: 依物流商而定 (如 `N0928478`)
  - 異動可能性: 建單後不變

- **OrderNo**: 商家訂單編號
  - 格式: 商家自訂 (如 `WXRAR8GLK1735201551`)
  - 異動可能性: 建單後不變

- **receiver_storename**: 收件門市名稱
  - 來源: 建單時選擇或API查詢
  - 異動可能性: 建單後可能透過改店功能變更
  - 特殊處理: 全家門市會移除"全家"前綴

- **return_storename**: 退件門市名稱
  - 來源: 建單時選擇
  - 異動可能性: 建單後較少變更
  - 特殊值: `NNNNNN` 表示未設定

- **Receiver_Phone**: 收件人電話 (加密儲存)
  - 用途: 買家到店通知簡訊
  - 異動可能性: 建單後不變

- **Sender_Phone**: 寄件人電話 (加密儲存)
  - 用途: 退貨通知簡訊
  - 異動可能性: 建單後不變

#### member 資料表
- **checkpw**: 帳號認證碼
  - 來源: 系統自動產生
  - 用途: 首次登入驗證
  - 異動可能性: 每次重發驗證碼時更新

### 動態計算欄位

#### 物流商名稱
- **方法**: `Cls_Service.GetLogistic_ServiceCVSName()`
- **來源**: `LogisticService` 資料表
- **可能值**: 7-11、全家、萊爾富、OK、黑貓
- **對應代碼**:
  - `01`: 7-11 C2C
  - `02`: 全家 C2C
  - `03`: 全家 C2C (無金流)
  - `04`: 全家 B2C
  - `10`: 黑貓宅配
  - `22`: 黑貓低溫宅配
  - `23`: 全家冷凍
  - `24`: 全家冷凍 B2C

#### 剩餘取貨天數
- **方法**: `Cls_Service.GetLogistic_ReturnDayStr()`
- **計算邏輯**:
  - 從到店日期起算
  - 各物流商有不同的保管天數設定
  - 黑貓低溫固定4天
  - 其他超商一般7天
- **顯示格式**:
  - `>= 1日`: "{天數}日內"
  - `0日`: "今日內"
  - 指定日期: "{YYYY/MM/DD}前"

#### 門市名稱
- **來源1**: 資料庫 `Order_Info.receiver_storename`
- **來源2**: 即時API查詢
  - 7-11: `ReCallGet_711MapStoreName()`
  - 全家: `Sel_FamiStoreCurrentStoreId()` / `Sel_FamiStoreShipDate()`
- **處理邏輯**:
  - 優先使用資料庫值
  - 若為空則透過API查詢
  - 全家門市移除"全家"前綴
  - 自動補上"門市"後綴

---

## 📊 簡訊發送統計與追蹤

### 資料表記錄

#### MailList 資料表
- 用途: 記錄首次簡訊/email發送狀態
- 關鍵欄位:
  - `smsUUID`: 簡訊唯一識別碼
  - `sms_batchsending_key`: 批次發送批號
  - `MailStatus`: 郵件狀態 (`1`=到店, `2`=退貨)

#### MailList2nd 資料表
- 用途: 記錄第二次催取簡訊/email發送狀態
- 關鍵欄位:
  - `sms_uuid`: 簡訊唯一識別碼
  - `sms_batchsending_key`: 批次發送批號

### 發送排程

#### 定時任務 (Hangfire)
1. **sched_smsToBuyer**: 首次到店通知
   - 執行頻率: 定時排程
   - 處理對象: `MailList` 未發送的簡訊

2. **sched_smsToBuyer2nd**: 第二次催取通知
   - 執行頻率: 定時排程
   - 處理對象: `MailList2nd` 未發送的簡訊

### 批次發送機制
- **批次大小**: 可設定 (變數 `batchSendNum`)
- **UUID追蹤**: 每則簡訊有獨立UUID
- **批號記錄**: 每批發送有唯一 `BatchID` (GUID)
- **冪等性保證**: 使用 `Idempotency-Key` 避免重複發送

---

## ⚠️ 特殊規則與例外處理

### 1. 7-11 特殊子代碼處理
**規則**: eshopid 為 `73E` 或 `73F` 的訂單不發送簡訊
**原因**: 這些訂單由7-11自行發送簡訊
**程式碼位置**: `Cls_Order.cs:21026-21033`

### 2. 物流服務簡訊排除規則

#### 不發送到店通知的服務
- `03`: 全家 C2C (無金流) - 使用全家自有簡訊系統
- `04`: 全家 B2C - 使用全家自有簡訊系統
- `10`: 黑貓宅配 - 黑貓自行發送通知
- `23`: 全家冷凍 - 使用全家自有簡訊系統
- `24`: 全家冷凍 B2C - 使用全家自有簡訊系統

### 3. 字數限制處理
**限制**: 簡訊最多80字
**處理邏輯**:
1. 檢查完整簡訊長度
2. 若超過80字,計算超出字數
3. 從 `mem_Branchwebname` 截短相應字數
4. 重新組裝簡訊內容

**程式碼位置**: `Cls_Order.cs:20436-20450`

### 4. 門市名稱處理規則

#### 全家門市特殊處理
- 移除前綴"全家"兩字
- 例: "全家台北信義門市" → "台北信義門市"

#### 自動補充"門市"後綴
- 檢查門市名稱是否包含"門市"
- 若無則自動補上

#### 空值處理
- 若資料庫無門市名稱,透過API查詢
- 查詢失敗時使用預設值或省略門市名稱

### 5. 退件門市特殊值
**特殊值**: `NNNNNN`
**含義**: 未設定退件門市
**顯示**: "退件門市" (通用名稱)

---

## 🛡️ 簡訊白名單建議

### 樣板認證清單

根據盤點結果,建議註冊以下簡訊樣板:

#### 樣板 1: 帳號認證簡訊
```
您Paynow物流平台的認證碼是:$$1$$
```
**變數**: `$$1$$` = 6位數驗證碼

#### 樣板 2: 到店通知簡訊
```
您於$$1$$消費的貨品已送達$$2$$$$3$$門市  請於$$4$$完成取貨
```
**變數**:
- `$$1$$` = 商家網站名稱 (最多60字)
- `$$2$$` = 物流商名稱 (4-6字: 7-11、全家、萊爾富、OK、黑貓)
- `$$3$$` = 門市名稱 (最多30字)
- `$$4$$` = 取貨期限 (格式: `{N}日內` 或 `{YYYY/MM/DD}前`)

#### 樣板 3: 退貨到店通知簡訊
```
訂單編號:$$1$$的退貨商品已抵達$$2$$  請於$$3$$往領取  貨運編號:$$4$$
```
**變數**:
- `$$1$$` = 訂單編號 (最多20字)
- `$$2$$` = 退件門市名稱 (最多30字)
- `$$3$$` = 取貨期限 (格式: `{N}日內`)
- `$$4$$` = 貨運單號 (最多15字)

### 變數長度限制建議

| 變數類型 | 建議最大長度 | 實際可能範圍 | 資料庫欄位型別 |
|---------|------------|------------|--------------|
| 商家網站名稱 | 60字 | 5-60字 | NVARCHAR |
| 門市名稱 | 30字 | 5-30字 | NVARCHAR |
| 訂單編號 | 20字 | 10-20字 | VARCHAR |
| 貨運單號 | 15字 | 6-15字 | VARCHAR |
| 驗證碼 | 6字 | 6字 | VARCHAR |
| 物流商名稱 | 6字 | 2-6字 | 固定清單 |
| 取貨期限 | 15字 | 5-15字 | 計算產生 |

### 白名單設定建議

**申請方式**:
1. 向簡訊供應商 (Every8D) 提交樣板審核
2. 每個樣板提供3-5個實際發送範例
3. 說明變數用途和業務場景

**審核要點**:
- 不包含敏感詞彙
- 變數位置明確標示
- 符合電信法規要求

**系統調整**:
1. 修改 `SmsContent()` 方法使用樣板變數
2. 新增樣板ID對應邏輯
3. 發送前驗證變數長度

---

## 🗑️ 廢棄程式碼標註

### 1. SmsContent 第二個方法 (已廢棄)
**位置**: `Cls_Order.cs:20475`
```csharp
public string SmsContent(string webname, string Delivery_Status, string LogisticNumber, string sno, int day)
```
**狀態**: ⚠️ **已廢棄** - 完全沒有被呼叫,可考慮移除
**說明**: 此方法與第一個 SmsContent 方法功能重複,但格式不同,且從未被使用

### 2. smsenum.sched_smsToSender (已廢棄)
**位置**: `enums\smsenum.cs:13`
```csharp
sched_smsToSender,
```
**狀態**: ⚠️ **已廢棄** - 只有定義,從未使用
**說明**: 可能原本計劃用於寄件人簡訊通知,但最終未實作,可考慮移除

---

## 📝 程式碼改善建議

### 1. 修正文字錯誤
**優先級**: 高
- **帳號認證簡訊**: 統一「Paynow」大小寫為「PayNow」
  - `MemberController.cs:6498` → 改為「PayNow」
  - `MemberController.cs:6735` → 改為「PayNow」
- **退貨通知簡訊**: 補上缺少的「前」字
  - `Cls_Order.cs:20465` → 「往領取」改為「前往領取」

### 2. 樣板化簡訊內容
**現況**: 簡訊內容在程式碼中硬編碼組裝
**建議**: 建立簡訊樣板管理機制

```csharp
// 建議新增樣板枚舉
public enum SmsTemplateEnum
{
    AccountVerification = 1,  // 帳號認證
    ArrivalNotice = 2,        // 到店通知
    ReturnNotice = 3          // 退貨通知
}

// 建議新增樣板管理類別
public class SmsTemplateManager
{
    public string GetTemplate(SmsTemplateEnum template)
    {
        // 從資料庫或設定檔讀取樣板
    }

    public string FillTemplate(string template, Dictionary<string, string> variables)
    {
        // 填入變數並驗證長度
    }
}
```

### 2. 變數長度驗證
**現況**: 僅在超過80字時才截斷
**建議**: 發送前預先驗證各變數長度

```csharp
public class SmsVariableValidator
{
    public ValidationResult Validate(Dictionary<string, string> variables)
    {
        // 檢查各變數是否超過建議長度
        // 提供警告訊息
    }
}
```

### 3. 移除廢棄程式碼
**優先級**: 中
- 移除 `SmsContent(string webname, ...)` 方法 (`Cls_Order.cs:20475`)
- 移除 `smsenum.sched_smsToSender` 枚舉值
- 確認無其他參照後再移除

### 4. 集中管理簡訊發送邏輯
**現況**: 簡訊組裝分散在多個方法中
**建議**: 建立統一的簡訊服務層

```csharp
public class SmsService
{
    public bool SendAccountVerification(string phone, string code) { }
    public bool SendArrivalNotice(Order order) { }
    public bool SendReturnNotice(Order order) { }
}
```

### 5. 簡訊發送記錄增強
**建議新增欄位**:
- `template_id`: 使用的樣板ID
- `template_version`: 樣板版本
- `variables`: JSON格式儲存變數內容
- `character_count`: 實際字數

---

## 📈 未來擴充建議

### 1. 多語系支援
- 建立多語系樣板表
- 根據買家語系偏好選擇樣板

### 2. 個人化內容
- 允許商家自訂部分簡訊內容
- 提供樣板變數自訂功能

### 3. A/B Testing
- 測試不同簡訊內容的取貨率
- 優化簡訊文案

### 4. 簡訊成效追蹤
- 記錄簡訊開啟率 (若簡訊商支援)
- 追蹤簡訊後取貨時間
- 分析簡訊效益

---

## 🔗 相關文件

- 簡訊API文件: `https://message.paynow.com.tw/api/docs`
- Every8D簡訊規範: (待補充)
- 電信法規參考: (待補充)

---

## 📞 聯絡資訊

**負責團隊**: PayNow 物流研發團隊
**問題回報**: kevin@paynow.com.tw

---

**盤點完成日期**: 2025-10-17
**下次檢視日期**: 2026-04-17 (建議每半年檢視一次)

---

# 📋 簡訊樣板範本 (供相關人員確認)

## 樣板一:帳號認證簡訊

**樣板格式**:
```
您Paynow物流平台的認證碼是:{驗證碼}
```
或
```
您paynow物流平台的認證碼是:{驗證碼}
```

**實際範例**:
```
您Paynow物流平台的認證碼是:123456
您paynow物流平台的認證碼是:789012
您Paynow物流平台的認證碼是:456789
```

**⚠️ 程式碼問題提醒**:
目前程式碼中有兩處發送認證簡訊,但大小寫不一致:
- `MemberController.cs:6498` - 使用「Paynow」(P大寫)
- `MemberController.cs:6735` - 使用「paynow」(p小寫)
建議統一為「PayNow」(駝峰式命名)

---

## 樣板二:到店通知簡訊

**樣板格式**:
```
您於{商家網站名稱}消費的貨品已送達{物流商}{門市名稱}門市  請於{天數}完成取貨
```

**實際範例**:
```
您於PayNow測試商店消費的貨品已送達7-11竹北光明門市  請於7日內完成取貨
您於WACA購物網消費的貨品已送達全家台北信義門市  請於2025/10/20前完成取貨
您於台灣好農消費的貨品已送達萊爾富新竹光復門市  請於今日內完成取貨
您於蝦皮商城消費的貨品已送達OK桃園中正門市  請於3日內完成取貨
您於生鮮購物網消費的貨品已送達黑貓竹北取貨站門市  請於4日內完成取貨
```

**說明**:
- 第一次到店通知和第二次催取通知使用相同樣板
- 天數格式: `N日內` 或 `YYYY/MM/DD前` 或 `今日內`
- **注意**: 此樣板不包含「貨運編號」資訊(與退貨通知不同)

---

## 樣板三:退貨到店通知簡訊

**樣板格式**:
```
訂單編號:{訂單編號}的退貨商品已抵達{退件門市}  請於{天數}前往領取  貨運編號:{貨運單號}
```

**實際範例**:
```
訂單編號:W7J9JQZQD1735193909的退貨商品已抵達7-11竹北光明門市  請於7日內前往領取  貨運編號:N0871666
訂單編號:WXRAR8GLK1735201551的退貨商品已抵達退件門市  請於今日內前往領取  貨運編號:N0928478
訂單編號:ABC123XYZ456789的退貨商品已抵達全家台北松山門市  請於5日內前往領取  貨運編號:F1234567
訂單編號:ORDER2024010112345的退貨商品已抵達萊爾富新竹東門門市  請於7日內前往領取  貨運編號:HL987654
```

**⚠️ 程式碼問題提醒**:
目前程式碼中有兩個 `SmsContent` 方法,文字不一致:
- `Cls_Order.cs:20465` - 使用「往領取」(缺少「前」字,文法不順)
- `Cls_Order.cs:20502` - 使用「前往領取」(正確)
建議修正第一個方法,統一改為「前往領取」
